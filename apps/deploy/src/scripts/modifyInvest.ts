import { signAndExecuteTransaction } from '@/sdk/utils';
import { ADMIN_CAP, INVEST, NODES, PACKAGE_ID } from '@/sdk/constants';
import { adminKeypair } from '@/sdk';
import { MODULE_CLOB } from '@local/airdrop-sdk/airdrop';
import { Transaction } from '@mysten/sui/transactions';

const data = {
  RECORDS: [
    {
      id: 298,
      inviter_id: null,
      address:
        '0xd6e0ffaba6696fc7416ef01223e9faaa7b6dfa88f68922d7a618376d3fc22001',
      inviter: null,
      is_bind: 1,
      sharer_ids: '299',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: null,
      tx_digest: null,
      is_root: 0,
      total_gains: 300000000,
      total_gains_update_at: 1735345697,
      total_investment: 0,
      total_investment_update_at: 0,
      join_at: null,
    },
    {
      id: 299,
      inviter_id: 298,
      address:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      inviter:
        '0xd6e0ffaba6696fc7416ef01223e9faaa7b6dfa88f68922d7a618376d3fc22001',
      is_bind: 1,
      sharer_ids: '300,302,303,306,308,314',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'Ht6hQoyhSypRsexeuKua1Dx791MQrsQgkT5RRYTiqYTm',
      is_root: 0,
      total_gains: 15500000000,
      total_gains_update_at: 1736661631,
      total_investment: 3000000000,
      total_investment_update_at: 1735345697,
      join_at: 1735345657,
    },
    {
      id: 300,
      inviter_id: 299,
      address:
        '0x9754c7ca7f7383bd3745ddfa5950e8ef744d2a48ce95f0ddc855202a250272c9',
      inviter:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      is_bind: 1,
      sharer_ids: '301',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '7MoxNn1RGbG4Jq5vuZNjiN9ZPJBqUPLGAV7VzFiyyL8X',
      is_root: 0,
      total_gains: 200000000,
      total_gains_update_at: 1735371552,
      total_investment: 3000000000,
      total_investment_update_at: 1735371200,
      join_at: 1735371119,
    },
    {
      id: 301,
      inviter_id: 300,
      address:
        '0x3eed05a622c43fc838587f3eacfa1f2cc44f3fef408eeb0176b42bb87facea9c',
      inviter:
        '0x9754c7ca7f7383bd3745ddfa5950e8ef744d2a48ce95f0ddc855202a250272c9',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '3R25PkCTwrqcGix3Uj1YUHfFkocSiEyUYXHk1XazQP3D',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 2000000000,
      total_investment_update_at: 1735371552,
      join_at: 1735371533,
    },
    {
      id: 302,
      inviter_id: 299,
      address:
        '0x8b96346e047881f94678899ba5354f5ee00ea2f03d8b3b28c1aa9e897e8e3a3b',
      inviter:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      is_bind: 1,
      sharer_ids: '304,305,309',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '6kvF3cADJvas8GfMqWRmqowhqxsv6w8JZYQ6CT4K6Vm7',
      is_root: 0,
      total_gains: 42200000000,
      total_gains_update_at: 1737090595,
      total_investment: 3000000000,
      total_investment_update_at: 1735391510,
      join_at: 1735391470,
    },
    {
      id: 303,
      inviter_id: 299,
      address:
        '0x8e3351b2c87fb95734eeb903bb7f1fc4af60abcdea90c37f06e192a4e29c552b',
      inviter:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '7kLkdpXoWsowBUenZRaC6aaAMV329ZQ91vHyfbVEfB69',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 0,
      total_investment_update_at: 0,
      join_at: 1735968039,
    },
    {
      id: 304,
      inviter_id: 302,
      address:
        '0xa84a8b2f4ee1efd7e234c23ef65a7e18467da525a0c74258f63e13690c31b7d7',
      inviter:
        '0x8b96346e047881f94678899ba5354f5ee00ea2f03d8b3b28c1aa9e897e8e3a3b',
      is_bind: 1,
      sharer_ids: '311,316,318,320',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '4G4mnrPio4LULvGW7oqh9cLTQBS9W1w14DmkDXw1s8P9',
      is_root: 0,
      total_gains: 44100000000,
      total_gains_update_at: 1737617685,
      total_investment: 3000000000,
      total_investment_update_at: 1736218664,
      join_at: 1736218647,
    },
    {
      id: 305,
      inviter_id: 302,
      address:
        '0x8991e9a07ab3ce8023b7f0b1983e591507bffb883886c0e1cac169a8b582a3e4',
      inviter:
        '0x8b96346e047881f94678899ba5354f5ee00ea2f03d8b3b28c1aa9e897e8e3a3b',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '4YTeNpGB9dME7kKb61AEZgmMo2wFpAaTSncjeFLfgGBt',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 3000000000,
      total_investment_update_at: 1736218727,
      join_at: 1736218711,
    },
    {
      id: 306,
      inviter_id: 299,
      address:
        '0x4274587d091df9a2e5d18de0a6dfce9ba0b3e08cfe5e6a886d323c70e8f8906e',
      inviter:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      is_bind: 1,
      sharer_ids: '307',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'ETv5KioW7rD7Fat6Mq29sGWLzV8Vdsh62d7RM5bfYrjZ',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 149000000000,
      total_investment_update_at: 1736661631,
      join_at: 1736498759,
    },
    {
      id: 307,
      inviter_id: 306,
      address:
        '0xf9bad2a307ded33c7af240ebd3e5de2e29fffd222dc99ba9fc9eb0e43eea4248',
      inviter:
        '0x4274587d091df9a2e5d18de0a6dfce9ba0b3e08cfe5e6a886d323c70e8f8906e',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '3BwjggH57RJbg9UsTdbPS7GhtY5VWBKFffZRso6ACc8h',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 0,
      total_investment_update_at: 0,
      join_at: 1736660457,
    },
    {
      id: 308,
      inviter_id: 299,
      address:
        '0x42c8590a09315830a495cd1dc6b54cf3997b18dbb31018ad1a996027b76991fd',
      inviter:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '2dDsiF43cwdW2zUR7HZBKRZNXkSe7W2urskXHmZ7d89Y',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 0,
      total_investment_update_at: 0,
      join_at: 1736920281,
    },
    {
      id: 309,
      inviter_id: 302,
      address:
        '0x1ad43888109493ee62fa92113b39bb873fa6a936ce519741768e420b9c2c4cb1',
      inviter:
        '0x8b96346e047881f94678899ba5354f5ee00ea2f03d8b3b28c1aa9e897e8e3a3b',
      is_bind: 1,
      sharer_ids: '310',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '3F8TewW8Hb6y2qJkR96X8XFJUvDHV6mCLLe2hrzzK9vL',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 416000000000,
      total_investment_update_at: 1737090595,
      join_at: 1737079015,
    },
    {
      id: 310,
      inviter_id: 309,
      address:
        '0xacbde984e4ce08c6d42b2294cc92be85e4116652f2334a28a3097692e3ef4719',
      inviter:
        '0x1ad43888109493ee62fa92113b39bb873fa6a936ce519741768e420b9c2c4cb1',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '5bHB9AGJLo3SHhZRxyoGdkjfo2UnnQr4UwSBroGvmiwk',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 0,
      total_investment_update_at: 0,
      join_at: 1737104070,
    },
    {
      id: 311,
      inviter_id: 304,
      address:
        '0x2fabaada3a075bd4b1304a0cf409d6e4d7c24aab4bd8983250fc038d61316369',
      inviter:
        '0xa84a8b2f4ee1efd7e234c23ef65a7e18467da525a0c74258f63e13690c31b7d7',
      is_bind: 1,
      sharer_ids: '312,313,317',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '6a3k3fa2sBYxUJWvwAmzWaMsfG1WWV2Y9wqq15B9XCFq',
      is_root: 0,
      total_gains: 35500000000,
      total_gains_update_at: 1737448372,
      total_investment: 143000000000,
      total_investment_update_at: 1737178010,
      join_at: 1737177863,
    },
    {
      id: 312,
      inviter_id: 311,
      address:
        '0x346224111a7d8111d25f817eef8e7a3cc5a9b6fe2d8e8702a456e78b81546b6f',
      inviter:
        '0x2fabaada3a075bd4b1304a0cf409d6e4d7c24aab4bd8983250fc038d61316369',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'D9zYG5iK8VLzTMANEvQGQhDg7QsaGRYKCCWwdi5YgN7t',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 143000000000,
      total_investment_update_at: 1737278054,
      join_at: 1737278025,
    },
    {
      id: 313,
      inviter_id: 311,
      address:
        '0xd7bc2067ef43ce3e83a5074562ec77c50981c767ebd28a20d5cbd50e17c0ddf8',
      inviter:
        '0x2fabaada3a075bd4b1304a0cf409d6e4d7c24aab4bd8983250fc038d61316369',
      is_bind: 1,
      sharer_ids: '315',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '9dFCZGXJGxfJkrfmQnDPTDm5N5EyrzbitY1qC17U3mzB',
      is_root: 0,
      total_gains: 15300000000,
      total_gains_update_at: 1737382292,
      total_investment: 143000000000,
      total_investment_update_at: 1737279449,
      join_at: 1737279435,
    },
    {
      id: 314,
      inviter_id: 299,
      address:
        '0x969da8606d87c91a024626697d39243e054648ac3d3525adce2fcc7d0303bd10',
      inviter:
        '0x2ff7e1caaab6dbe36bf791ca3ece7dea7371cc2480bda6337754024b322fa985',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '5tshALx4hDQixzdZNVhy1q1RehBNhTNgtVZB7z74sod8',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 0,
      total_investment_update_at: 0,
      join_at: 1737368306,
    },
    {
      id: 315,
      inviter_id: 313,
      address:
        '0xb16cea469041c13183cca70e9c6fea7ac6a16730982762b54820b090fca01976',
      inviter:
        '0xd7bc2067ef43ce3e83a5074562ec77c50981c767ebd28a20d5cbd50e17c0ddf8',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'DZ7CN5oXiSU5Nr8nMGQynejhPPv7jkyeTMf74gdNRCQ8',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 153000000000,
      total_investment_update_at: 1737382292,
      join_at: 1737382271,
    },
    {
      id: 316,
      inviter_id: 304,
      address:
        '0xbf6a4ec8bece1f835256eaba532b07d8d32904f8a708f40fcaa9a060f9853e26',
      inviter:
        '0xa84a8b2f4ee1efd7e234c23ef65a7e18467da525a0c74258f63e13690c31b7d7',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'EvQm2t75QkKjVme1dQVFnfCUwcGS24Vczts299EQJGBD',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 160000000000,
      total_investment_update_at: 1737430564,
      join_at: 1737430551,
    },
    {
      id: 317,
      inviter_id: 311,
      address:
        '0xd83371a15322e1030fb4328864cd32937e1ad18bf39f9e001a33013f4ff075b6',
      inviter:
        '0x2fabaada3a075bd4b1304a0cf409d6e4d7c24aab4bd8983250fc038d61316369',
      is_bind: 1,
      sharer_ids: '319',
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'H5JcvY6MNvyiTaatx9qo1m266kuLNp3MWygqSJhPAe1E',
      is_root: 0,
      total_gains: 6900000000,
      total_gains_update_at: 1737611716,
      total_investment: 69000000000,
      total_investment_update_at: 1737448372,
      join_at: 1737448359,
    },
    {
      id: 318,
      inviter_id: 304,
      address:
        '0x87f97ab5e8cfd27ccc6d57e3aa16b84ed3509f7757071cc6da253ab48a8797c4',
      inviter:
        '0xa84a8b2f4ee1efd7e234c23ef65a7e18467da525a0c74258f63e13690c31b7d7',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '3a1DphWnHpircSz4a2nt96VLShTdgPz9DgsqtYNorxan',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 69000000000,
      total_investment_update_at: 1737606845,
      join_at: 1737606806,
    },
    {
      id: 319,
      inviter_id: 317,
      address:
        '0xbaa9cb4b008370f91abf283b14f5df438e891b30784809a802d16a9fc21df2d7',
      inviter:
        '0xd83371a15322e1030fb4328864cd32937e1ad18bf39f9e001a33013f4ff075b6',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: 'A1dJUyymXD6C8X13pGHYjWWcv6yi1UsR53ZS9SMnZnwi',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 69000000000,
      total_investment_update_at: 1737611716,
      join_at: 1737611701,
    },
    {
      id: 320,
      inviter_id: 304,
      address:
        '0xac831948fb52f035dc54105d3f40852646d78594b710f9bd2f36031259669ed4',
      inviter:
        '0xa84a8b2f4ee1efd7e234c23ef65a7e18467da525a0c74258f63e13690c31b7d7',
      is_bind: 1,
      sharer_ids: null,
      create_at: 1738418400,
      update_at: 1739438247,
      event_seq: '0',
      tx_digest: '8BQF8MeJu4qGGBRH3Sk5CrizfYpgzxc7Fwc8qBy29zax',
      is_root: 0,
      total_gains: 0,
      total_gains_update_at: 0,
      total_investment: 69000000000,
      total_investment_update_at: 1737617685,
      join_at: 1737617677,
    },
  ],
};

const main = async () => {
  const tx = new Transaction();

  data.RECORDS.map((item) => {
    const { address, total_investment, total_gains } = item;
    tx.moveCall({
      typeArguments: [],
      target: `${PACKAGE_ID}::${MODULE_CLOB}::modify_invest`,
      arguments: [
        tx.object(ADMIN_CAP),
        tx.object(INVEST),
        tx.object(NODES),
        tx.pure.address(address),
        tx.pure.u64(total_investment),
        tx.pure.u64(total_gains),
        tx.pure.u64(total_investment),
        tx.pure.u64(total_gains),
      ],
    });
  });

  const res = await signAndExecuteTransaction(tx, adminKeypair);
  console.log({ res });
  console.log('modify_invest success');
};

main().catch(({ message }) => {
  console.log({ message });
});
